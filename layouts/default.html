<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title><%= @config[:title] %> - <%= @item[:title] %></title>
    <meta name="author" content="Charlotte">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/stylesheet.css">
    <link rel="stylesheet" href="/syntax.css">

    <% if articles.any? { |i| !i[:draft] } %>
      <link href="/atom.xml" rel="alternate" title="<%= @config[:title] %>" type="application/atom+xml">
    <% end %>
    <meta name="generator" content="Nanoc <%= Nanoc::VERSION %>">
  </head>
  <body id="top">
    <div class="flex">
      <main>
        <h1><%= @item[:title] %></h1>
        <% if created_at = @item[:created_at] %>
          <p class="created-at"><%= created_at.strftime("%Y-%m-%d") %></p>
        <% end %>
        <%= yield %>
      </main>
      <div class="sidebar">
        <div class="sidebar-inner">
          <ul>
            <% home = @items["/index.*"] %>
            <li class="<%= item == home ? "active" : "" %>"><%= link_to "Home", home %></li>
            <li><%= link_to "Author", "https://github.com/charlottia", rel: "me" %></li>
          </ul>

          <% if (items = sorted_articles.select { |item| !item[:draft] }).any? %>
            <h2>Notes</h2>
            <ul>
              <% items.each do |item| %>
                <li class="<%= item == @item ? "active" : "" %>"><%= link_to item[:title], item %></li>
              <% end %>
            </ul>
          <% end %>

          <% if (items = sorted_articles.select { |item| item[:draft] }).any? %>
            <h2>Drafts</h2>
            <ul>
              <% items.each do |item| %>
                <li class="<%= item == @item ? "active" : "" %>"><%= link_to item[:title], item %></li>
              <% end %>
            </ul>
          <% end %>
        </div>

        <% if toc %>
          <div class="toc">
            <div class="toc-inner">
              <h2>Table of contents</h2>

              <ul>
                <li>
                  <a href="#top">Top</a>
                  <% toc_walker do |event:, **details| %>
                    <% if event == :nest %>
                      <ul><li>
                    <% elsif event == :unnest %>
                      </li></ul>
                    <% elsif event == :item %>
                      <% if !details[:first] %>
                        </li><li>
                      <% end %>
                      <%= link_to details[:text], details[:href] %>
                    <% end %>
                  <% end %>
                </li>
              </ul>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <footer>
      <p>
        Licensed under the <a
        href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>
        by its author.
      </p>
    </footer>
    <script src="/toc-highlight.js"></script>
  </body>
</html>
